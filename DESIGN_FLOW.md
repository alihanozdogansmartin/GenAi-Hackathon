# ğŸ¯ Vodafone Call Center AI Analysis - Low-Level Design Flow

## ğŸ“‹ System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (React)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  Customer    â”‚  â”‚    Agent     â”‚  â”‚    Admin     â”‚               â”‚
â”‚  â”‚    View      â”‚  â”‚    View      â”‚  â”‚  Dashboard   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                 â”‚                  â”‚                        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                  â”‚                 â”‚                                  â”‚
â”‚            WebSocket            REST API                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                 â”‚
                   â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND (FastAPI)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚            WebSocket Manager                         â”‚            â”‚
â”‚  â”‚  - Connection Management                             â”‚            â”‚
â”‚  â”‚  - Message Broadcasting                              â”‚            â”‚
â”‚  â”‚  - Conversation Buffering                            â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                    â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚                 â–¼                                     â”‚            â”‚
â”‚  â”‚     AI Analysis Engine (GPT-OSS-20B)                 â”‚            â”‚
â”‚  â”‚  - Sentiment Analysis                                â”‚            â”‚
â”‚  â”‚  - Resolution Quality                                â”‚            â”‚
â”‚  â”‚  - Agent Performance                                 â”‚            â”‚
â”‚  â”‚  - Customer Emotion Detection                        â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                     â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â–¼                  â–¼               â–¼                 â–¼              â”‚
â”‚ SQLite DB     ChromaDB         Admin API        Stats API           â”‚
â”‚ (Conversations) (Vector Search) (Dashboard)      (Metrics)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Detailed Flow Diagrams

### 1ï¸âƒ£ Customer-Agent Real-Time Conversation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CUSTOMER   â”‚                                           â”‚    AGENT     â”‚
â”‚     UI       â”‚                                           â”‚      UI      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                                          â”‚
       â”‚ 1. Connect WebSocket                                    â”‚ 1. Connect WebSocket
       â”‚    ws://localhost:8000/ws/customer/{id}                 â”‚    ws://localhost:8000/ws/agent/{id}
       â–¼                                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     WebSocket Manager (Backend)                           â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Connection Pool:                                           â”‚          â”‚
â”‚  â”‚    {                                                        â”‚          â”‚
â”‚  â”‚      "customer-1234": WebSocket,                            â”‚          â”‚
â”‚  â”‚      "agent-5678": WebSocket                                â”‚          â”‚
â”‚  â”‚    }                                                        â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Conversation Buffers:                                      â”‚          â”‚
â”‚  â”‚    {                                                        â”‚          â”‚
â”‚  â”‚      "customer-1234": "MÃ¼ÅŸteri: Faturamda hata var\n...",  â”‚          â”‚
â”‚  â”‚      "agent-5678": "MÃ¼ÅŸteri: Faturamda hata var\n..."      â”‚          â”‚
â”‚  â”‚    }                                                        â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â–²                                                          â–²
       â”‚                                                          â”‚
       â”‚ 2. Message Flow                                         â”‚ 2. Message Flow
       â”‚                                                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                           â”‚
â”‚  Customer sends:                          Agent sends:                   â”‚
â”‚  {                                        {                              â”‚
â”‚    "type": "add_text",                     "type": "add_text",           â”‚
â”‚    "text": "MÃ¼ÅŸteri: Faturamda hata var"   "text": "Temsilci: ..."      â”‚
â”‚  }                                        }                              â”‚
â”‚                                                                           â”‚
â”‚                     â–¼ BROADCAST TO ALL â–¼                                 â”‚
â”‚                                                                           â”‚
â”‚  Both receive:                                                           â”‚
â”‚  {                                                                       â”‚
â”‚    "type": "new_message",                                                â”‚
â”‚    "text": "MÃ¼ÅŸteri: Faturamda hata var",                               â”‚
â”‚    "role": "customer",                                                   â”‚
â”‚    "timestamp": "2026-01-15T10:30:00"                                    â”‚
â”‚  }                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2ï¸âƒ£ AI Analysis Flow (Agent Triggered)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    AGENT     â”‚
â”‚     UI       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Trigger Analysis
       â”‚    { "type": "analyze" }
       â”‚    OR
       â”‚    Live Mode Auto-Trigger
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Backend - Analysis Handler                  â”‚
â”‚                                                          â”‚
â”‚  1. Get Conversation Buffer                             â”‚
â”‚     buffer = manager.get_buffer(client_id)              â”‚
â”‚     â†“                                                    â”‚
â”‚     "MÃ¼ÅŸteri: Faturamda hata var                        â”‚
â”‚      Temsilci: Hemen kontrol ediyorum                   â”‚
â”‚      ..."                                               â”‚
â”‚                                                          â”‚
â”‚  2. Send "Analyzing" Status                             â”‚
â”‚     { "type": "analyzing" } â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Agent   â”‚
â”‚                                                          â”‚
â”‚  3. Call GPT-OSS-20B API                                â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚     â”‚  Prompt Engineering:                â”‚             â”‚
â”‚     â”‚  - System Context                   â”‚             â”‚
â”‚     â”‚  - Conversation Text                â”‚             â”‚
â”‚     â”‚  - Analysis Criteria                â”‚             â”‚
â”‚     â”‚    â€¢ Sentiment (1-10)               â”‚             â”‚
â”‚     â”‚    â€¢ Resolution (1-10)              â”‚             â”‚
â”‚     â”‚    â€¢ Agent Performance (1-10)       â”‚             â”‚
â”‚     â”‚    â€¢ Customer Emotion               â”‚             â”‚
â”‚     â”‚    â€¢ Response Time                  â”‚             â”‚
â”‚     â”‚    â€¢ Empathy Level                  â”‚             â”‚
â”‚     â”‚    â€¢ Problem Resolved (bool)        â”‚             â”‚
â”‚     â”‚    â€¢ Insights Array                 â”‚             â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                    â”‚                                     â”‚
â”‚                    â–¼                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚     â”‚  OpenAI Client (httpx)           â”‚                â”‚
â”‚     â”‚  base_url: practicus.vodafone... â”‚                â”‚
â”‚     â”‚  model: gpt-oss-20b              â”‚                â”‚
â”‚     â”‚  temperature: 0.3                â”‚                â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                    â”‚                                     â”‚
â”‚                    â–¼                                     â”‚
â”‚  4. Parse JSON Response                                 â”‚
â”‚     {                                                    â”‚
â”‚       "sentiment": 7,                                    â”‚
â”‚       "resolution": 9,                                   â”‚
â”‚       "agentPerformance": 8,                             â”‚
â”‚       "insights": [...],                                 â”‚
â”‚       "metrics": {                                       â”‚
â”‚         "responseTime": "HÄ±zlÄ±",                         â”‚
â”‚         "empathyLevel": "YÃ¼ksek",                        â”‚
â”‚         "problemResolved": true,                         â”‚
â”‚         "customerEmotion": "Pozitif"                     â”‚
â”‚       }                                                  â”‚
â”‚     }                                                    â”‚
â”‚                                                          â”‚
â”‚  5. Calculate Overall Score                             â”‚
â”‚     overall = (sentiment + resolution + performance) / 3 â”‚
â”‚                                                          â”‚
â”‚  6. Save to Database                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚     â”‚  SQLite: conversations table   â”‚                  â”‚
â”‚     â”‚  - customer_message            â”‚                  â”‚
â”‚     â”‚  - agent_message               â”‚                  â”‚
â”‚     â”‚  - sentiment_score (0-1)       â”‚                  â”‚
â”‚     â”‚  - resolution_score (0-1)      â”‚                  â”‚
â”‚     â”‚  - agent_performance (0-1)     â”‚                  â”‚
â”‚     â”‚  - overall_score (0-1)         â”‚                  â”‚
â”‚     â”‚  - is_resolved                 â”‚                  â”‚
â”‚     â”‚  - customer_emotion            â”‚                  â”‚
â”‚     â”‚  - response_time               â”‚                  â”‚
â”‚     â”‚  - empathy_level               â”‚                  â”‚
â”‚     â”‚  - category                    â”‚                  â”‚
â”‚     â”‚  - timestamp                   â”‚                  â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                  â”‚                                       â”‚
â”‚  7. Add to Vector DB (ChromaDB)                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚     â”‚  ChromaDB Collection       â”‚                      â”‚
â”‚     â”‚  - Issue ID: conv_123      â”‚                      â”‚
â”‚     â”‚  - Issue Text (embedded)   â”‚                      â”‚
â”‚     â”‚  - Metadata:               â”‚                      â”‚
â”‚     â”‚    * category              â”‚                      â”‚
â”‚     â”‚    * emotion               â”‚                      â”‚
â”‚     â”‚    * resolution            â”‚                      â”‚
â”‚     â”‚    * sentiment             â”‚                      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                          â”‚
â”‚  8. Send Analysis Result                                â”‚
â”‚     {                                                    â”‚
â”‚       "type": "analysis_result",                         â”‚
â”‚       "analysis": { ... },                               â”‚
â”‚       "conversation": "...",                             â”‚
â”‚       "timestamp": "..."                                 â”‚
â”‚     } â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Agent     â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      AGENT UI UPDATES        â”‚
â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Overall Score: 8/10   â”‚  â”‚
â”‚  â”‚  Sentiment: 7/10       â”‚  â”‚
â”‚  â”‚  Resolution: 9/10      â”‚  â”‚
â”‚  â”‚  Performance: 8/10     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Metrics:              â”‚  â”‚
â”‚  â”‚  â€¢ Response: HÄ±zlÄ±     â”‚  â”‚
â”‚  â”‚  â€¢ Empathy: YÃ¼ksek     â”‚  â”‚
â”‚  â”‚  â€¢ Resolved: âœ“ Yes     â”‚  â”‚
â”‚  â”‚  â€¢ Emotion: Pozitif    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AI Insights:          â”‚  â”‚
â”‚  â”‚  âœ… Professional       â”‚  â”‚
â”‚  â”‚  âš ï¸ Wait time issue    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3ï¸âƒ£ Admin Dashboard Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ADMIN     â”‚
â”‚  Dashboard   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ HTTP GET Requests
       â”‚
       â”œâ”€â”€ GET /api/admin/dashboard?date=2026-01-15
       â”‚
       â”œâ”€â”€ GET /api/admin/conversations?skip=0&limit=20&category=billing
       â”‚
       â”œâ”€â”€ GET /api/admin/daily-reports?start_date=2026-01-01
       â”‚
       â”œâ”€â”€ GET /api/admin/database-stats
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Backend REST API                            â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Dashboard Endpoint                             â”‚         â”‚
â”‚  â”‚  /api/admin/dashboard                           â”‚         â”‚
â”‚  â”‚                                                  â”‚         â”‚
â”‚  â”‚  1. Query SQLite Database                       â”‚         â”‚
â”‚  â”‚     db.query(Conversation)                      â”‚         â”‚
â”‚  â”‚     .filter(date == target_date)                â”‚         â”‚
â”‚  â”‚                                                  â”‚         â”‚
â”‚  â”‚  2. Aggregate Statistics                        â”‚         â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚         â”‚
â”‚  â”‚     â”‚  Total Conversations         â”‚            â”‚         â”‚
â”‚  â”‚     â”‚  Resolved Count              â”‚            â”‚         â”‚
â”‚  â”‚     â”‚  Avg Satisfaction (0-1)      â”‚            â”‚         â”‚
â”‚  â”‚     â”‚  Avg Resolution (0-1)        â”‚            â”‚         â”‚
â”‚  â”‚     â”‚  Avg Performance (0-1)       â”‚            â”‚         â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚         â”‚
â”‚  â”‚                                                  â”‚         â”‚
â”‚  â”‚  3. Emotion Distribution                        â”‚         â”‚
â”‚  â”‚     Counter({                                    â”‚         â”‚
â”‚  â”‚       "satisfied": 45,                           â”‚         â”‚
â”‚  â”‚       "neutral": 20,                             â”‚         â”‚
â”‚  â”‚       "frustrated": 12                           â”‚         â”‚
â”‚  â”‚     })                                           â”‚         â”‚
â”‚  â”‚                                                  â”‚         â”‚
â”‚  â”‚  4. Hourly Distribution                         â”‚         â”‚
â”‚  â”‚     {                                            â”‚         â”‚
â”‚  â”‚       "9": {"count": 8, "avg_score": 0.82},     â”‚         â”‚
â”‚  â”‚       "10": {"count": 12, "avg_score": 0.75}... â”‚         â”‚
â”‚  â”‚     }                                            â”‚         â”‚
â”‚  â”‚                                                  â”‚         â”‚
â”‚  â”‚  5. Common Issues (from ChromaDB)               â”‚         â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚         â”‚
â”‚  â”‚     â”‚  ChromaDB Query             â”‚             â”‚         â”‚
â”‚  â”‚     â”‚  - Find similar issues      â”‚             â”‚         â”‚
â”‚  â”‚     â”‚  - Cluster by category      â”‚             â”‚         â”‚
â”‚  â”‚     â”‚  - Count occurrences        â”‚             â”‚         â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚         â”‚
â”‚  â”‚                                                  â”‚         â”‚
â”‚  â”‚  6. Recent Conversations (last 10)              â”‚         â”‚
â”‚  â”‚                                                  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                         â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Conversations Endpoint                           â”‚         â”‚
â”‚  â”‚  /api/admin/conversations                         â”‚         â”‚
â”‚  â”‚                                                    â”‚         â”‚
â”‚  â”‚  1. Apply Filters                                 â”‚         â”‚
â”‚  â”‚     - category (billing, technical, etc.)         â”‚         â”‚
â”‚  â”‚     - is_resolved (true/false)                    â”‚         â”‚
â”‚  â”‚                                                    â”‚         â”‚
â”‚  â”‚  2. Pagination                                    â”‚         â”‚
â”‚  â”‚     .offset(skip).limit(limit)                    â”‚         â”‚
â”‚  â”‚                                                    â”‚         â”‚
â”‚  â”‚  3. Return Full Conversation Objects              â”‚         â”‚
â”‚  â”‚     [{                                             â”‚         â”‚
â”‚  â”‚       id, timestamp, customer_message,            â”‚         â”‚
â”‚  â”‚       agent_message, category, scores...          â”‚         â”‚
â”‚  â”‚     }]                                             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Daily Reports Endpoint                             â”‚         â”‚
â”‚  â”‚  /api/admin/daily-reports                           â”‚         â”‚
â”‚  â”‚                                                      â”‚         â”‚
â”‚  â”‚  1. Query DailyReport Table                         â”‚         â”‚
â”‚  â”‚     db.query(DailyReport)                           â”‚         â”‚
â”‚  â”‚     .filter(date >= start_date)                     â”‚         â”‚
â”‚  â”‚     .order_by(date.desc())                          â”‚         â”‚
â”‚  â”‚                                                      â”‚         â”‚
â”‚  â”‚  2. Return Aggregated Daily Stats                   â”‚         â”‚
â”‚  â”‚     [{                                               â”‚         â”‚
â”‚  â”‚       date, total_conversations,                    â”‚         â”‚
â”‚  â”‚       resolved_conversations,                       â”‚         â”‚
â”‚  â”‚       avg_sentiment, avg_satisfaction,              â”‚         â”‚
â”‚  â”‚       avg_performance, top_emotion, top_category    â”‚         â”‚
â”‚  â”‚     }]                                               â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Database Stats Endpoint                             â”‚        â”‚
â”‚  â”‚  /api/admin/database-stats                           â”‚        â”‚
â”‚  â”‚                                                       â”‚        â”‚
â”‚  â”‚  1. Get Unique Categories                            â”‚        â”‚
â”‚  â”‚     db.query(Conversation.category)                  â”‚        â”‚
â”‚  â”‚     .filter(category != NULL)                        â”‚        â”‚
â”‚  â”‚     .distinct()                                       â”‚        â”‚
â”‚  â”‚                                                       â”‚        â”‚
â”‚  â”‚  2. Get Unique Emotions                              â”‚        â”‚
â”‚  â”‚     db.query(Conversation.customer_emotion)          â”‚        â”‚
â”‚  â”‚     .filter(customer_emotion != NULL)                â”‚        â”‚
â”‚  â”‚     .distinct()                                       â”‚        â”‚
â”‚  â”‚                                                       â”‚        â”‚
â”‚  â”‚  3. Return Filter Options                            â”‚        â”‚
â”‚  â”‚     {                                                 â”‚        â”‚
â”‚  â”‚       "categories": ["billing", "technical"...],     â”‚        â”‚
â”‚  â”‚       "emotions": ["satisfied", "neutral"...]        â”‚        â”‚
â”‚  â”‚     }                                                 â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ JSON Response
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Admin Dashboard UI                        â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Summary Cards                                       â”‚      â”‚
â”‚  â”‚  â€¢ Total: 66 conversations                           â”‚      â”‚
â”‚  â”‚  â€¢ Resolved: 52 (78.8%)                              â”‚      â”‚
â”‚  â”‚  â€¢ Avg Satisfaction: 7.2/10                          â”‚      â”‚
â”‚  â”‚  â€¢ Avg Performance: 8.1/10                           â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Charts                                              â”‚      â”‚
â”‚  â”‚  â€¢ Emotion Distribution (Pie Chart)                  â”‚      â”‚
â”‚  â”‚  â€¢ Hourly Trends (Line Chart)                        â”‚      â”‚
â”‚  â”‚  â€¢ Category Breakdown (Bar Chart)                    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Database Table View                                 â”‚      â”‚
â”‚  â”‚  â€¢ Filters: Category, Resolved Status               â”‚      â”‚
â”‚  â”‚  â€¢ Pagination: 20 items/page                         â”‚      â”‚
â”‚  â”‚  â€¢ Click Row â†’ Modal with full conversation          â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4ï¸âƒ£ Vector Database Similarity Search Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         New Customer Issue Arrives                      â”‚
â”‚  "Ä°nternetim Ã§ok yavaÅŸ, dÃ¼zelteceÄŸim"                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ 1. After Analysis & DB Save
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         add_issue_to_vector_db()                        â”‚
â”‚                                                         â”‚
â”‚  1. Generate Embedding                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â”‚  ChromaDB Embedding Function        â”‚            â”‚
â”‚     â”‚  (Default: all-MiniLM-L6-v2)        â”‚            â”‚
â”‚     â”‚                                     â”‚            â”‚
â”‚     â”‚  Input: "Ä°nternetim Ã§ok yavaÅŸ..."   â”‚            â”‚
â”‚     â”‚  Output: [0.123, -0.456, ...] (384) â”‚            â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                         â”‚
â”‚  2. Store in ChromaDB                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â”‚  Collection: "customer_issues"      â”‚            â”‚
â”‚     â”‚                                     â”‚            â”‚
â”‚     â”‚  IDs: ["conv_123"]                  â”‚            â”‚
â”‚     â”‚  Documents: ["Ä°nternetim Ã§ok..."]   â”‚            â”‚
â”‚     â”‚  Embeddings: [[0.123, -0.456...]]   â”‚            â”‚
â”‚     â”‚  Metadata: [{                       â”‚            â”‚
â”‚     â”‚    "category": "technical",         â”‚            â”‚
â”‚     â”‚    "sentiment": 0.4,                â”‚            â”‚
â”‚     â”‚    "resolved": true,                â”‚            â”‚
â”‚     â”‚    "emotion": "frustrated"          â”‚            â”‚
â”‚     â”‚  }]                                 â”‚            â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ Later: Agent needs similar cases
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         find_similar_issues()                           â”‚
â”‚                                                         â”‚
â”‚  Input: "Ä°nternet baÄŸlantÄ±sÄ± sorunlu"                  â”‚
â”‚                                                         â”‚
â”‚  1. Query ChromaDB                                     â”‚
â”‚     collection.query(                                  â”‚
â”‚       query_texts=["Ä°nternet baÄŸlantÄ±sÄ± sorunlu"],    â”‚
â”‚       n_results=5,                                     â”‚
â”‚       where={"category": "technical"}  # Optional      â”‚
â”‚     )                                                  â”‚
â”‚                                                         â”‚
â”‚  2. Cosine Similarity Matching                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚     â”‚  Vector Distance Calculation     â”‚               â”‚
â”‚     â”‚                                  â”‚               â”‚
â”‚     â”‚  Query: [0.111, -0.444, ...]     â”‚               â”‚
â”‚     â”‚                                  â”‚               â”‚
â”‚     â”‚  vs DB Vectors:                  â”‚               â”‚
â”‚     â”‚  â€¢ "Ä°nternetim Ã§ok yavaÅŸ"        â”‚               â”‚
â”‚     â”‚    Distance: 0.12 (Very Similar) â”‚               â”‚
â”‚     â”‚                                  â”‚               â”‚
â”‚     â”‚  â€¢ "Faturamda hata var"          â”‚               â”‚
â”‚     â”‚    Distance: 0.85 (Not Similar)  â”‚               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚  3. Return Top 5 Matches                               â”‚
â”‚     [                                                   â”‚
â”‚       {                                                 â”‚
â”‚         "id": "conv_123",                              â”‚
â”‚         "issue": "Ä°nternetim Ã§ok yavaÅŸ, dÃ¼zelteceÄŸim", â”‚
â”‚         "distance": 0.12,                              â”‚
â”‚         "metadata": {                                  â”‚
â”‚           "category": "technical",                     â”‚
â”‚           "resolved": true,                            â”‚
â”‚           "solution": "Modem resetlendi"               â”‚
â”‚         }                                               â”‚
â”‚       },                                                â”‚
â”‚       ...                                               â”‚
â”‚     ]                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Use Case: Agent Support                         â”‚
â”‚                                                         â”‚
â”‚  Show agent previous similar issues and solutions      â”‚
â”‚  to help resolve current customer problem faster       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Database Schema

### SQLite Tables

#### 1. conversations
```sql
CREATE TABLE conversations (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    session_id VARCHAR,                 -- WebSocket client ID
    customer_message TEXT,              -- Full customer messages
    agent_message TEXT,                 -- Full agent responses
    timestamp DATETIME DEFAULT NOW,
    
    -- AI Analysis Results (normalized 0-1)
    sentiment_score FLOAT,              -- Customer satisfaction
    resolution_score FLOAT,             -- Problem resolution quality
    agent_performance FLOAT,            -- Agent performance score
    overall_score FLOAT,                -- Average of above
    
    -- Categorical Data
    is_resolved BOOLEAN DEFAULT FALSE,  -- Problem resolved?
    customer_emotion VARCHAR,           -- satisfied, neutral, frustrated
    response_time VARCHAR,              -- HÄ±zlÄ±, Orta, YavaÅŸ
    empathy_level VARCHAR,              -- high, medium, low
    category VARCHAR,                   -- billing, technical, account, etc.
    keywords TEXT                       -- JSON array of keywords
);

CREATE INDEX idx_session ON conversations(session_id);
CREATE INDEX idx_timestamp ON conversations(timestamp);
CREATE INDEX idx_category ON conversations(category);
```

#### 2. daily_reports
```sql
CREATE TABLE daily_reports (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    date DATETIME,
    
    -- Daily Aggregates
    total_conversations INTEGER,
    resolved_conversations INTEGER,
    
    -- Average Scores
    avg_sentiment FLOAT,
    avg_satisfaction FLOAT,
    avg_performance FLOAT,
    
    -- Top Values
    top_emotion VARCHAR,                -- Most common emotion
    top_category VARCHAR,               -- Most common category
    
    created_at DATETIME DEFAULT NOW
);

CREATE INDEX idx_date ON daily_reports(date);
```

### ChromaDB Collection

```python
Collection: "customer_issues"
â”œâ”€â”€ IDs: ["conv_1", "conv_2", ...]
â”œâ”€â”€ Documents: [
â”‚   "Ä°nternetim Ã§ok yavaÅŸ, dÃ¼zelteceÄŸim",
â”‚   "Faturamda hatalÄ± Ã¼cret var",
â”‚   ...
â”‚]
â”œâ”€â”€ Embeddings: [
â”‚   [0.123, -0.456, 0.789, ...],  # 384-dim vector
â”‚   [0.234, -0.567, 0.890, ...],
â”‚   ...
â”‚]
â””â”€â”€ Metadata: [
    {
      "category": "technical",
      "emotion": "frustrated",
      "resolved": true,
      "sentiment": 0.6,
      "timestamp": "2026-01-15"
    },
    ...
]
```

---

## ğŸ“¡ WebSocket Message Types

### Customer â†’ Backend
```json
{
  "type": "add_text",
  "text": "MÃ¼ÅŸteri: Ä°nternetim Ã§ok yavaÅŸ"
}
```

### Agent â†’ Backend
```json
{
  "type": "add_text",
  "text": "Temsilci: Hemen kontrol ediyorum"
}

{
  "type": "analyze"
}

{
  "type": "live_mode",
  "enabled": true
}

{
  "type": "clear"
}
```

### Backend â†’ Client (Broadcast)
```json
{
  "type": "new_message",
  "text": "MÃ¼ÅŸteri: Ä°nternetim Ã§ok yavaÅŸ",
  "role": "customer",
  "from_client": "customer-1234",
  "timestamp": "2026-01-15T10:30:00"
}

{
  "type": "analysis_result",
  "analysis": {
    "sentiment": 7,
    "resolution": 9,
    "agentPerformance": 8,
    "insights": [
      {
        "type": "success",
        "text": "Temsilci profesyonel yanÄ±t verdi"
      }
    ],
    "metrics": {
      "responseTime": "HÄ±zlÄ±",
      "empathyLevel": "YÃ¼ksek",
      "problemResolved": true,
      "customerEmotion": "Pozitif"
    }
  },
  "conversation": "MÃ¼ÅŸteri: ...\nTemsilci: ...",
  "timestamp": "2026-01-15T10:31:00"
}

{
  "type": "analyzing",
  "message": "Analiz yapÄ±lÄ±yor..."
}

{
  "type": "error",
  "message": "BaÄŸlantÄ± hatasÄ±"
}
```

---

## ğŸ” Environment Variables

```bash
# .env file
GPT_OSS_API_KEY=your_api_key_here
proxy_username=username
proxy_password=password
PRACTICUS_USERNAME=username
PRACTICUS_PASSWORD=password
```

---

## ğŸ“Š AI Model Integration

### GPT-OSS-20B Configuration
```python
base_url = "https://practicus.vodafone.local/models/model-gateway-ai-hackathon/latest/v1"

client = OpenAI(
    base_url=base_url,
    api_key=api_key,
    http_client=httpx.Client(
        verify=False,      # SSL bypass for internal network
        timeout=60.0
    )
)

response = client.chat.completions.create(
    model="gpt-oss-20b",
    messages=[
        {
            "role": "system",
            "content": "Sen bir mÃ¼ÅŸteri hizmetleri analiz uzmanÄ±sÄ±n..."
        },
        {
            "role": "user",
            "content": conversation_text
        }
    ],
    temperature=0.3,       # Low for consistent analysis
    max_tokens=1000
)
```

### Prompt Template
```
AÅŸaÄŸÄ±daki mÃ¼ÅŸteri hizmetleri konuÅŸmasÄ±nÄ± detaylÄ± analiz et:

KonuÅŸma:
{conversation_text}

Analiz kriterleri:
1. sentiment: MÃ¼ÅŸteri memnuniyeti (1-10)
2. resolution: Ã‡Ã¶zÃ¼m kalitesi (1-10)
3. agentPerformance: Temsilci performansÄ± (1-10)
4. insights: Ä°Ã§gÃ¶rÃ¼ler dizisi (2-5 adet)
5. metrics: YanÄ±t sÃ¼resi, empati, duygu, Ã§Ã¶zÃ¼m durumu

JSON formatÄ±nda yanÄ±t ver:
{
  "sentiment": number,
  "resolution": number,
  "agentPerformance": number,
  "insights": [
    {"type": "success/warning/info", "text": "..."}
  ],
  "metrics": {
    "responseTime": "HÄ±zlÄ±/Orta/YavaÅŸ",
    "empathyLevel": "YÃ¼ksek/Orta/DÃ¼ÅŸÃ¼k",
    "problemResolved": boolean,
    "customerEmotion": "Pozitif/NÃ¶tr/Negatif"
  }
}
```

---

## ğŸš€ Tech Stack Summary

### Frontend
- **Framework**: React 19.2.3
- **Styling**: Tailwind CSS
- **Icons**: Lucide React
- **State**: React Hooks (useState, useEffect, useRef)
- **Communication**: WebSocket API

### Backend
- **Framework**: FastAPI 0.104.1
- **ORM**: SQLAlchemy 2.0.23
- **Database**: SQLite (conversations.db)
- **Vector DB**: ChromaDB (chroma.sqlite3)
- **AI**: OpenAI Python SDK (for GPT-OSS-20B)
- **WebSocket**: FastAPI WebSocket support
- **HTTP Client**: httpx (for proxy)

### AI/ML
- **LLM**: GPT-OSS-20B (Practicus AI)
- **Embeddings**: all-MiniLM-L6-v2 (ChromaDB default)
- **Vector Search**: Cosine similarity

---

## ğŸ“ˆ Performance Metrics

- **WebSocket Latency**: < 50ms (local network)
- **AI Analysis Time**: 2-5 seconds
- **Database Query**: < 100ms
- **Vector Search**: < 200ms (for 1000+ documents)
- **Concurrent Users**: Supports 100+ simultaneous WebSocket connections

---

## ğŸ¯ Key Features

1. âœ… **Real-time bidirectional communication** (Customer â†” Agent)
2. âœ… **AI-powered sentiment analysis** (GPT-OSS-20B)
3. âœ… **Live analysis mode** (automatic on each message)
4. âœ… **Vector similarity search** (ChromaDB)
5. âœ… **Admin dashboard** (statistics, charts, filters)
6. âœ… **Database viewer** (conversations table with modal)
7. âœ… **Daily reports** (aggregated statistics)
8. âœ… **Conversation history** (persistent storage)

---

## ğŸ”® Future Enhancements

1. ğŸ”„ Multi-language support
2. ğŸ“± Mobile app (React Native)
3. ğŸ”” Real-time notifications
4. ğŸ“Š Advanced analytics (ML clustering)
5. ğŸ¤– Auto-response suggestions
6. ğŸ” Full-text search
7. ğŸ“¤ Export reports (PDF, Excel)
8. ğŸ” Role-based access control (RBAC)

---

## ğŸ“ Notes

- **WebSocket Sync**: All clients receive same messages (broadcast)
- **Buffer Management**: Each client maintains separate conversation buffer
- **Normalization**: Scores stored as 0-1 in DB, displayed as 1-10 in UI
- **Emotion Mapping**: Turkish â†’ English for consistency
- **Category Filters**: Dynamic based on actual data in DB
- **Pagination**: 20 items per page (configurable)

